<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDGVM Update Project: crops Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="styleSheet.css" rel="stylesheet" type="text/css" />
<link href="styleSheetExtra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
  <tbody>
    <tr style="height: 100px;">
      <td id="projectLC3M" width="30%"><a href="http://lc3m.org"><img alt="Logo" src="images/LC3M2.png"/></a>
      </td>
      <td style="width=40%">
        <table width="100%">
          <tr> <td align="center"><div class="projectname"><span>S</span>heffield <span>D</span>ynamic <span>G</span>lobal</div></td></tr>
          <tr> <td align="center"><div class="projectname"><span>V</span>egetation <span>M</span>odel</div></td></tr>
        </table>
      </td>
      <td id="projectSU" width="30%"><a href="http://www.sheffield.ac.uk"><img alt="Logo" src="images/Sheffield_University2.png"/></a>
      </td>
     </tr>
   </tbody>
  </table>
</div> <!-- Title area div
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacecrops.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">crops Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Crop subroutines.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a132790a49a69bada45c7aaf94deb1a78"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a132790a49a69bada45c7aaf94deb1a78">seasonality</a> (tmp, prc, cld, thty_dys, nft, year, nn1)</td></tr>
<tr class="memdesc:a132790a49a69bada45c7aaf94deb1a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crops Seasonality.  <a href="#a132790a49a69bada45c7aaf94deb1a78">More...</a><br /></td></tr>
<tr class="separator:a132790a49a69bada45c7aaf94deb1a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a828fad9eba6de472f05ac315951cc364"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a828fad9eba6de472f05ac315951cc364">getwet</a> (hrs, q, wet, pet, nn1)</td></tr>
<tr class="separator:a828fad9eba6de472f05ac315951cc364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17583c09ce9f145f979e68da90b8375"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#ad17583c09ce9f145f979e68da90b8375">summerday</a> (thresh, mmid, nn1)</td></tr>
<tr class="memdesc:ad17583c09ce9f145f979e68da90b8375"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the start day of summer as defined by a threshold temperature.  <a href="#ad17583c09ce9f145f979e68da90b8375">More...</a><br /></td></tr>
<tr class="separator:ad17583c09ce9f145f979e68da90b8375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8946984659d8cc631e0f90913c45e2"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a2c8946984659d8cc631e0f90913c45e2">winterday</a> (thresh, mmid, nn1)</td></tr>
<tr class="memdesc:a2c8946984659d8cc631e0f90913c45e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the start day of winter as defined by a threshold temperature.  <a href="#a2c8946984659d8cc631e0f90913c45e2">More...</a><br /></td></tr>
<tr class="separator:a2c8946984659d8cc631e0f90913c45e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9094e82a42f3669f55be6ba1d2e8d3b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#ac9094e82a42f3669f55be6ba1d2e8d3b">wangengel</a> (tmin, topt, tmax, tmp, dtype, popt, pcrit, p, ft, fp)</td></tr>
<tr class="memdesc:ac9094e82a42f3669f55be6ba1d2e8d3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get temperature and photoperiod response function values for crops.  <a href="#ac9094e82a42f3669f55be6ba1d2e8d3b">More...</a><br /></td></tr>
<tr class="separator:ac9094e82a42f3669f55be6ba1d2e8d3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d606228c6bf81247e263a6e8972c019"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a5d606228c6bf81247e263a6e8972c019">streck</a> (vtmin, vtopt, vtmax, tmp, dtype, popt, pcrit, p, vdays, fv)</td></tr>
<tr class="memdesc:a5d606228c6bf81247e263a6e8972c019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get vernalisation factors for crops.  <a href="#a5d606228c6bf81247e263a6e8972c019">More...</a><br /></td></tr>
<tr class="separator:a5d606228c6bf81247e263a6e8972c019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a991fb5e280a7bbe2301504d1d67627b1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a991fb5e280a7bbe2301504d1d67627b1">crop_outputs</a> (nft, sl)</td></tr>
<tr class="memdesc:a991fb5e280a7bbe2301504d1d67627b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output files for crops.  <a href="#a991fb5e280a7bbe2301504d1d67627b1">More...</a><br /></td></tr>
<tr class="separator:a991fb5e280a7bbe2301504d1d67627b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6875be9a19dd5b2213712f201b32ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a0b6875be9a19dd5b2213712f201b32ee">irrigate</a> (ft, sfc, sw)</td></tr>
<tr class="memdesc:a0b6875be9a19dd5b2213712f201b32ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decides irrigation and fills up relative soil layers.  <a href="#a0b6875be9a19dd5b2213712f201b32ee">More...</a><br /></td></tr>
<tr class="separator:a0b6875be9a19dd5b2213712f201b32ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a098565e13c689e9cc57739d0fb6f55e3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a098565e13c689e9cc57739d0fb6f55e3">fert_crops</a> (nft)</td></tr>
<tr class="memdesc:a098565e13c689e9cc57739d0fb6f55e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Effect of fertilizer usage on optimal crop LAI.  <a href="#a098565e13c689e9cc57739d0fb6f55e3">More...</a><br /></td></tr>
<tr class="separator:a098565e13c689e9cc57739d0fb6f55e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04103a2eec00e8fd02e7087063ac24b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#aa04103a2eec00e8fd02e7087063ac24b">read_fertilizers</a> (du, yr0, yrf, lat, lon, nft, cfert)</td></tr>
<tr class="separator:aa04103a2eec00e8fd02e7087063ac24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426b27f46e7bad2d8626e42b9bbb9700"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a426b27f46e7bad2d8626e42b9bbb9700">read_irrigation</a> (du, yr0, yrf, lat, lon, nft, cirr)</td></tr>
<tr class="separator:a426b27f46e7bad2d8626e42b9bbb9700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18560349606e089830719ec8296e7a70"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#a18560349606e089830719ec8296e7a70">harv</a> (lit, yielit)</td></tr>
<tr class="memdesc:a18560349606e089830719ec8296e7a70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Harvest of crops.  <a href="#a18560349606e089830719ec8296e7a70">More...</a><br /></td></tr>
<tr class="separator:a18560349606e089830719ec8296e7a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadfd0e46d3a409e7c6b1b3b3ab7cd06a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecrops.html#aadfd0e46d3a409e7c6b1b3b3ab7cd06a">read_opt_par</a> ()</td></tr>
<tr class="separator:aadfd0e46d3a409e7c6b1b3b3ab7cd06a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Crop subroutines. </p>
<dl class="section author"><dt>Author</dt><dd></dd></dl>
<dl class="section date"><dt>Date</dt><dd></dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a991fb5e280a7bbe2301504d1d67627b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a991fb5e280a7bbe2301504d1d67627b1">&#9670;&nbsp;</a></span>crop_outputs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::crop_outputs </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>sl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output files for crops. </p>
<dl class="section author"><dt>Author</dt><dd>EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Dec 2016 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00647">647</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="pft__parameters_8f90_source.html#l00066">pft_parameters::pft_tab</a>, <a class="el" href="site__parameters_8f90_source.html#l00067">site_parameters::ssp</a>, and <a class="el" href="system__state_8f90_source.html#l00137">system_state::ssv</a>.</p>

</div>
</div>
<a id="a098565e13c689e9cc57739d0fb6f55e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a098565e13c689e9cc57739d0fb6f55e3">&#9670;&nbsp;</a></span>fert_crops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::fert_crops </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nft</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Effect of fertilizer usage on optimal crop LAI. </p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Jan 2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00825">825</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="pft__parameters_8f90_source.html#l00066">pft_parameters::pft_tab</a>.</p>

<p class="reference">Referenced by <a class="el" href="sdgvm_8f90_source.html#l00009">sdgvm()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a098565e13c689e9cc57739d0fb6f55e3_icgraph.png" border="0" usemap="#namespacecrops_a098565e13c689e9cc57739d0fb6f55e3_icgraph" alt=""/></div>
<map name="namespacecrops_a098565e13c689e9cc57739d0fb6f55e3_icgraph" id="namespacecrops_a098565e13c689e9cc57739d0fb6f55e3_icgraph">
<area shape="rect" id="node2" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="172,5,231,32"/>
</map>
</div>

</div>
</div>
<a id="a828fad9eba6de472f05ac315951cc364"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a828fad9eba6de472f05ac315951cc364">&#9670;&nbsp;</a></span>getwet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::getwet </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(12)&#160;</td>
          <td class="paramname"><em>hrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(12)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>wet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(12)&#160;</td>
          <td class="paramname"><em>pet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate ratios of precipitation to evt van Bussel (2011) discusses determination of start of growing period in her chapter 5, section 2.2.2, and the sowing day should be the first day where precip&gt;0.1mm of that wet month. Calculate 4-month sums of prec/evt (petsum(12) and find the highest. Output the starting month of the highest (wet). We depart from van Bussel in that we do not use Priestley-Taylor PET, but instead lift Penman-Montheith code from of dolyday.</p>
<p>REFERENCES:</p>
<p>Waha et al 2012, Global Ecology and Biogeography 21:247-259 van Bussel et al 2015, Global Ecology and Biogeography (earlyview)</p>
<p>hrs(12) IN Daylight hours for the midday of each month q(12) IN Monthly photon flux density wet OUT Month index for start of wet season pet(12) OUT Monthly ratio precip/(potential evapotranspiration)</p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Oct 2016 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00358">358</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="site__parameters_8f90_source.html#l00067">site_parameters::ssp</a>.</p>

<p class="reference">Referenced by <a class="el" href="crops_8f90_source.html#l00058">seasonality()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a828fad9eba6de472f05ac315951cc364_icgraph.png" border="0" usemap="#namespacecrops_a828fad9eba6de472f05ac315951cc364_icgraph" alt=""/></div>
<map name="namespacecrops_a828fad9eba6de472f05ac315951cc364_icgraph" id="namespacecrops_a828fad9eba6de472f05ac315951cc364_icgraph">
<area shape="rect" id="node2" href="namespacecrops.html#a132790a49a69bada45c7aaf94deb1a78" title="Crops Seasonality. " alt="" coords="153,5,281,32"/>
<area shape="rect" id="node3" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="329,5,388,32"/>
</map>
</div>

</div>
</div>
<a id="a18560349606e089830719ec8296e7a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18560349606e089830719ec8296e7a70">&#9670;&nbsp;</a></span>harv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::harv </td>
          <td>(</td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>lit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>yielit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Harvest of crops. </p>
<dl class="section author"><dt>Author</dt><dd>EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Mar 2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l01193">1193</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="pft__parameters_8f90_source.html#l00066">pft_parameters::pft</a>, <a class="el" href="site__parameters_8f90_source.html#l00067">site_parameters::ssp</a>, and <a class="el" href="system__state_8f90_source.html#l00137">system_state::ssv</a>.</p>

<p class="reference">Referenced by <a class="el" href="phenology__methods_8f90_source.html#l00898">phenology_methods::allocation()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a18560349606e089830719ec8296e7a70_icgraph.png" border="0" usemap="#namespacecrops_a18560349606e089830719ec8296e7a70_icgraph" alt=""/></div>
<map name="namespacecrops_a18560349606e089830719ec8296e7a70_icgraph" id="namespacecrops_a18560349606e089830719ec8296e7a70_icgraph">
<area shape="rect" id="node2" href="namespacephenology__methods.html#a3febbb694107764cb8481db7eceef8e6" title="Allocate GPP between storage, stems, roots and leaves. " alt="" coords="139,5,285,47"/>
<area shape="rect" id="node3" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="333,13,392,39"/>
</map>
</div>

</div>
</div>
<a id="a0b6875be9a19dd5b2213712f201b32ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b6875be9a19dd5b2213712f201b32ee">&#9670;&nbsp;</a></span>irrigate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::irrigate </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(4)&#160;</td>
          <td class="paramname"><em>sfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(4)&#160;</td>
          <td class="paramname"><em>sw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decides irrigation and fills up relative soil layers. </p>
<p>sfc is soil field capacity in mm sw is soil wilting point in mm ssv(ft)soil_h2o is soil water content in mm We should also consider runoff.Ideally,we would check runoff before irrigating as it would give us the water available for irrigation. We would then subtract the water used for irrigation from runoff.</p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Jan 2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00749">749</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="pft__parameters_8f90_source.html#l00066">pft_parameters::pft</a>, and <a class="el" href="system__state_8f90_source.html#l00137">system_state::ssv</a>.</p>

<p class="reference">Referenced by <a class="el" href="sdgvm_8f90_source.html#l00009">sdgvm()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a0b6875be9a19dd5b2213712f201b32ee_icgraph.png" border="0" usemap="#namespacecrops_a0b6875be9a19dd5b2213712f201b32ee_icgraph" alt=""/></div>
<map name="namespacecrops_a0b6875be9a19dd5b2213712f201b32ee_icgraph" id="namespacecrops_a0b6875be9a19dd5b2213712f201b32ee_icgraph">
<area shape="rect" id="node2" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="155,5,213,32"/>
</map>
</div>

</div>
</div>
<a id="aa04103a2eec00e8fd02e7087063ac24b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa04103a2eec00e8fd02e7087063ac24b">&#9670;&nbsp;</a></span>read_fertilizers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::read_fertilizers </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>yr0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>yrf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(max_cohorts,max_years,3)&#160;</td>
          <td class="paramname"><em>cfert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section author"><dt>Author</dt><dd>EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Feb 2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00867">867</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="data_8f90_source.html#l01023">data::bi_lin()</a>, <a class="el" href="func_8f90_source.html#l00358">func::blank()</a>, <a class="el" href="func_8f90_source.html#l00475">func::in2st()</a>, <a class="el" href="func_8f90_source.html#l00444">func::n_fields()</a>, <a class="el" href="func_8f90_source.html#l00195">func::st2arr()</a>, <a class="el" href="func_8f90_source.html#l00540">func::stcmp()</a>, and <a class="el" href="func_8f90_source.html#l00325">func::stripb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="sdgvm_8f90_source.html#l00009">sdgvm()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_cgraph.png" border="0" usemap="#namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_cgraph" alt=""/></div>
<map name="namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_cgraph" id="namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_cgraph">
<area shape="rect" id="node2" href="namespacedata.html#a7f237cdc24b1a6135d9cf3165167e634" title="Performs bilinear interpolation between four points. " alt="" coords="207,5,292,32"/>
<area shape="rect" id="node3" href="namespacefunc.html#ae7fee9abde92c30ad3a8deb9a99049d6" title="func::blank" alt="" coords="491,107,577,133"/>
<area shape="rect" id="node4" href="namespacefunc.html#a24f6d9d9a8858dd4e9df3f6646a7d455" title="func::in2st" alt="" coords="208,259,291,285"/>
<area shape="rect" id="node5" href="namespacefunc.html#abb89e326d07cd48feb030cfea87514a8" title="func::n_fields" alt="" coords="200,157,299,184"/>
<area shape="rect" id="node8" href="namespacefunc.html#abacfb3d89c23cff8011641eda4245691" title="func::st2arr" alt="" coords="206,107,293,133"/>
<area shape="rect" id="node10" href="namespacefunc.html#aab7b0dfaa34943487f4602409e9522ed" title="func::stcmp" alt="" coords="204,309,295,336"/>
<area shape="rect" id="node11" href="namespacefunc.html#a041dd46fa24dab7c43457afc1c113cdc" title="func::stripb" alt="" coords="350,259,437,285"/>
<area shape="rect" id="node6" href="namespacefunc.html#a8875308fc3686bc3ab7f5f66e1160d14" title="func::blanks" alt="" coords="488,183,580,209"/>
<area shape="rect" id="node7" href="namespacefunc.html#a189c040b27ed84b4866807a6e4adc66d" title="func::stripbs" alt="" coords="347,157,440,184"/>
<area shape="rect" id="node9" href="namespacefunc.html#aa27c80c2c05030125823ac87065ee58b" title="func::stripbn" alt="" coords="347,107,440,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_icgraph.png" border="0" usemap="#namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_icgraph" alt=""/></div>
<map name="namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_icgraph" id="namespacecrops_aa04103a2eec00e8fd02e7087063ac24b_icgraph">
<area shape="rect" id="node2" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="200,5,259,32"/>
</map>
</div>

</div>
</div>
<a id="a426b27f46e7bad2d8626e42b9bbb9700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426b27f46e7bad2d8626e42b9bbb9700">&#9670;&nbsp;</a></span>read_irrigation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::read_irrigation </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>yr0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>yrf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(max_cohorts,max_years)&#160;</td>
          <td class="paramname"><em>cirr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section author"><dt>Author</dt><dd>EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Feb 2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l01036">1036</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="data_8f90_source.html#l01023">data::bi_lin()</a>, <a class="el" href="func_8f90_source.html#l00358">func::blank()</a>, <a class="el" href="func_8f90_source.html#l00475">func::in2st()</a>, <a class="el" href="func_8f90_source.html#l00444">func::n_fields()</a>, <a class="el" href="func_8f90_source.html#l00195">func::st2arr()</a>, <a class="el" href="func_8f90_source.html#l00540">func::stcmp()</a>, and <a class="el" href="func_8f90_source.html#l00325">func::stripb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="sdgvm_8f90_source.html#l00009">sdgvm()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_cgraph.png" border="0" usemap="#namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_cgraph" alt=""/></div>
<map name="namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_cgraph" id="namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_cgraph">
<area shape="rect" id="node2" href="namespacedata.html#a7f237cdc24b1a6135d9cf3165167e634" title="Performs bilinear interpolation between four points. " alt="" coords="203,5,288,32"/>
<area shape="rect" id="node3" href="namespacefunc.html#ae7fee9abde92c30ad3a8deb9a99049d6" title="func::blank" alt="" coords="487,107,573,133"/>
<area shape="rect" id="node4" href="namespacefunc.html#a24f6d9d9a8858dd4e9df3f6646a7d455" title="func::in2st" alt="" coords="204,259,287,285"/>
<area shape="rect" id="node5" href="namespacefunc.html#abb89e326d07cd48feb030cfea87514a8" title="func::n_fields" alt="" coords="196,157,295,184"/>
<area shape="rect" id="node8" href="namespacefunc.html#abacfb3d89c23cff8011641eda4245691" title="func::st2arr" alt="" coords="202,107,289,133"/>
<area shape="rect" id="node10" href="namespacefunc.html#aab7b0dfaa34943487f4602409e9522ed" title="func::stcmp" alt="" coords="200,309,291,336"/>
<area shape="rect" id="node11" href="namespacefunc.html#a041dd46fa24dab7c43457afc1c113cdc" title="func::stripb" alt="" coords="346,259,433,285"/>
<area shape="rect" id="node6" href="namespacefunc.html#a8875308fc3686bc3ab7f5f66e1160d14" title="func::blanks" alt="" coords="484,183,576,209"/>
<area shape="rect" id="node7" href="namespacefunc.html#a189c040b27ed84b4866807a6e4adc66d" title="func::stripbs" alt="" coords="343,157,436,184"/>
<area shape="rect" id="node9" href="namespacefunc.html#aa27c80c2c05030125823ac87065ee58b" title="func::stripbn" alt="" coords="343,107,436,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_icgraph.png" border="0" usemap="#namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_icgraph" alt=""/></div>
<map name="namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_icgraph" id="namespacecrops_a426b27f46e7bad2d8626e42b9bbb9700_icgraph">
<area shape="rect" id="node2" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="196,5,255,32"/>
</map>
</div>

</div>
</div>
<a id="aadfd0e46d3a409e7c6b1b3b3ab7cd06a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadfd0e46d3a409e7c6b1b3b3ab7cd06a">&#9670;&nbsp;</a></span>read_opt_par()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::read_opt_par </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section author"><dt>Author</dt><dd>EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>MAR 2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l01294">1294</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="pft__parameters_8f90_source.html#l00066">pft_parameters::pft_tab</a>.</p>

</div>
</div>
<a id="a132790a49a69bada45c7aaf94deb1a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a132790a49a69bada45c7aaf94deb1a78">&#9670;&nbsp;</a></span>seasonality()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::seasonality </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(12,31)&#160;</td>
          <td class="paramname"><em>tmp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(12,31)&#160;</td>
          <td class="paramname"><em>prc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(12)&#160;</td>
          <td class="paramname"><em>cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>thty_dys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Crops Seasonality. </p>
<p>Following Waha et al 2012 (published version of LGJ van Bussel's thesis (2011) chapter 5), calculate variation coefficients for seasonality, which may control sowing dates. Then, get the sowing day based on precipitation or summer/winter temperature thresholds for each crop. </p>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00058">58</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="light__methods_8f90_source.html#l00021">light_methods::dayl()</a>, <a class="el" href="crops_8f90_source.html#l00358">getwet()</a>, <a class="el" href="func_8f90_source.html#l00127">func::no_days()</a>, <a class="el" href="light__methods_8f90_source.html#l00065">light_methods::pfd()</a>, <a class="el" href="pft__parameters_8f90_source.html#l00066">pft_parameters::pft_tab</a>, <a class="el" href="site__parameters_8f90_source.html#l00067">site_parameters::ssp</a>, <a class="el" href="crops_8f90_source.html#l00604">streck()</a>, <a class="el" href="crops_8f90_source.html#l00439">summerday()</a>, <a class="el" href="crops_8f90_source.html#l00529">wangengel()</a>, and <a class="el" href="crops_8f90_source.html#l00486">winterday()</a>.</p>

<p class="reference">Referenced by <a class="el" href="sdgvm_8f90_source.html#l00009">sdgvm()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a132790a49a69bada45c7aaf94deb1a78_cgraph.png" border="0" usemap="#namespacecrops_a132790a49a69bada45c7aaf94deb1a78_cgraph" alt=""/></div>
<map name="namespacecrops_a132790a49a69bada45c7aaf94deb1a78_cgraph" id="namespacecrops_a132790a49a69bada45c7aaf94deb1a78_cgraph">
<area shape="rect" id="node2" href="namespacelight__methods.html#a460c621fdcfe4e59cf83e62e12cedb82" title="Calculates daylength (h) for the gridcell lat and day of year. " alt="" coords="181,5,316,32"/>
<area shape="rect" id="node3" href="namespacecrops.html#a828fad9eba6de472f05ac315951cc364" title="crops::getwet" alt="" coords="199,56,299,83"/>
<area shape="rect" id="node4" href="namespacefunc.html#ac36931ffa366eff3f57fb99c2ea5f53f" title="func::no_days" alt="" coords="197,107,300,133"/>
<area shape="rect" id="node5" href="namespacelight__methods.html#afdae8e8405ab30124af7a23ab9260137" title="Calculates total,direct and diffuse radiation for the day. " alt="" coords="185,157,313,184"/>
<area shape="rect" id="node6" href="namespacecrops.html#a5d606228c6bf81247e263a6e8972c019" title="Get vernalisation factors for crops. " alt="" coords="199,208,298,235"/>
<area shape="rect" id="node7" href="namespacecrops.html#ac9094e82a42f3669f55be6ba1d2e8d3b" title="Get temperature and photoperiod response function values for crops. " alt="" coords="364,233,487,260"/>
<area shape="rect" id="node8" href="namespacecrops.html#ad17583c09ce9f145f979e68da90b8375" title="Find the start day of summer as defined by a threshold temperature. " alt="" coords="183,309,314,336"/>
<area shape="rect" id="node9" href="namespacecrops.html#a2c8946984659d8cc631e0f90913c45e2" title="Find the start day of winter as defined by a threshold temperature. " alt="" coords="190,360,307,387"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a132790a49a69bada45c7aaf94deb1a78_icgraph.png" border="0" usemap="#namespacecrops_a132790a49a69bada45c7aaf94deb1a78_icgraph" alt=""/></div>
<map name="namespacecrops_a132790a49a69bada45c7aaf94deb1a78_icgraph" id="namespacecrops_a132790a49a69bada45c7aaf94deb1a78_icgraph">
<area shape="rect" id="node2" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="181,5,240,32"/>
</map>
</div>

</div>
</div>
<a id="a5d606228c6bf81247e263a6e8972c019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d606228c6bf81247e263a6e8972c019">&#9670;&nbsp;</a></span>streck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::streck </td>
          <td>(</td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>vtmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>vtopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>vtmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>tmp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>popt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>pcrit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>vdays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>fv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get vernalisation factors for crops. </p>
<p>Following Streck et al 2003, Ag For Meteor 115:139-150 Equations 3 and 4 (temperature function), 5 (photoperiod function) These functions are from Wang and Engel 1998 (Agri Sys 58:1-24). In some papers including Streck et al's first one (below) the temperature function has a typographical error (a minus sign is missing). The sum of the product of the temperature and photoperiod functions gives the effective vernalised days VD which one can use to get the vernalization response function (Eq 10) or Eq 2 in Streck et al 2003 Agron J 95:155-159</p>
<p>Streck et al's vernalisation function and Wang and Engel's functions are used in a number of models:</p>
<p>JULES-SUCROS land surface model (van den Hoof et al 2011 Ag For Meteor 151:137-153) DANUBIA crop growth model (Lenz-Wiedemann et al 2010 Ecol Model 221:314-329) FROSTOL wheat model (Bergjord et al 2008 Eur J Agr 28:321-330) SPACSYS C and N cycling model (Bingham and Wu 2011 Eur J Agr 34:181-189) CANDY-PLUS C, N and biomass model (Kruger et al 2013 Vadose Zone J 12) Liu's pasture legume model (Liu 2007 Field Crops Res 101:331-342)</p>
<p>vtmin,vtopt,vtmax input Cardinal temperatures for vernalisation tmp input Current mean daily temperature popt,pcrit input Optimal and critical photoperiod p input Current photoperiod dtype input -1: short-day, 1: long-day, 0: day-neutral vdays input/output Accumulated vernalisation days fv output Current vernalisation day</p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Oct 2016 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00604">604</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="crops_8f90_source.html#l00529">wangengel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="phenology__methods_8f90_source.html#l00591">phenology_methods::phenology3()</a>, and <a class="el" href="crops_8f90_source.html#l00058">seasonality()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a5d606228c6bf81247e263a6e8972c019_cgraph.png" border="0" usemap="#namespacecrops_a5d606228c6bf81247e263a6e8972c019_cgraph" alt=""/></div>
<map name="namespacecrops_a5d606228c6bf81247e263a6e8972c019_cgraph" id="namespacecrops_a5d606228c6bf81247e263a6e8972c019_cgraph">
<area shape="rect" id="node2" href="namespacecrops.html#ac9094e82a42f3669f55be6ba1d2e8d3b" title="Get temperature and photoperiod response function values for crops. " alt="" coords="152,5,275,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a5d606228c6bf81247e263a6e8972c019_icgraph.png" border="0" usemap="#namespacecrops_a5d606228c6bf81247e263a6e8972c019_icgraph" alt=""/></div>
<map name="namespacecrops_a5d606228c6bf81247e263a6e8972c019_icgraph" id="namespacecrops_a5d606228c6bf81247e263a6e8972c019_icgraph">
<area shape="rect" id="node2" href="namespacephenology__methods.html#a6206ebfca079af3c56d3c11d70b82c85" title="phenology_methods::\lphenology3" alt="" coords="152,5,299,47"/>
<area shape="rect" id="node5" href="namespacecrops.html#a132790a49a69bada45c7aaf94deb1a78" title="Crops Seasonality. " alt="" coords="356,71,484,98"/>
<area shape="rect" id="node3" href="namespacephenology__methods.html#a147419bfb677634e26bf5de75edc2714" title="phenology_methods::\lphenology" alt="" coords="347,5,493,47"/>
<area shape="rect" id="node4" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="541,42,600,69"/>
</map>
</div>

</div>
</div>
<a id="ad17583c09ce9f145f979e68da90b8375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17583c09ce9f145f979e68da90b8375">&#9670;&nbsp;</a></span>summerday()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function crops::summerday </td>
          <td>(</td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(12)&#160;</td>
          <td class="paramname"><em>mmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the start day of summer as defined by a threshold temperature. </p>
<p>van Bussel (2011, thesis) discusses determination of sowing dates in her chapter 5, section 2.2.2; here we find the day number when summer begins (temperature&gt;=threshold). We linearly interpolate between the average monthly temperatures to get the mean day.</p>
<p>thresh IN threshold temperature for summer mmid(12) IN Midday of month in Julian days</p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Oct 2016 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00439">439</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="site__parameters_8f90_source.html#l00067">site_parameters::ssp</a>.</p>

<p class="reference">Referenced by <a class="el" href="crops_8f90_source.html#l00058">seasonality()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_ad17583c09ce9f145f979e68da90b8375_icgraph.png" border="0" usemap="#namespacecrops_ad17583c09ce9f145f979e68da90b8375_icgraph" alt=""/></div>
<map name="namespacecrops_ad17583c09ce9f145f979e68da90b8375_icgraph" id="namespacecrops_ad17583c09ce9f145f979e68da90b8375_icgraph">
<area shape="rect" id="node2" href="namespacecrops.html#a132790a49a69bada45c7aaf94deb1a78" title="Crops Seasonality. " alt="" coords="184,5,312,32"/>
<area shape="rect" id="node3" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="360,5,419,32"/>
</map>
</div>

</div>
</div>
<a id="ac9094e82a42f3669f55be6ba1d2e8d3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9094e82a42f3669f55be6ba1d2e8d3b">&#9670;&nbsp;</a></span>wangengel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine crops::wangengel </td>
          <td>(</td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>tmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>topt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>tmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>tmp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>popt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>pcrit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get temperature and photoperiod response function values for crops. </p>
<p>These functions are from Wang and Engel 1998 (Agri Sys 58:1-24). The sum of the product of the temperature and photoperiod functions gives the effective physiological days.</p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Oct 2016 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00529">529</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="phenology__methods_8f90_source.html#l00591">phenology_methods::phenology3()</a>, <a class="el" href="crops_8f90_source.html#l00058">seasonality()</a>, and <a class="el" href="crops_8f90_source.html#l00604">streck()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_ac9094e82a42f3669f55be6ba1d2e8d3b_icgraph.png" border="0" usemap="#namespacecrops_ac9094e82a42f3669f55be6ba1d2e8d3b_icgraph" alt=""/></div>
<map name="namespacecrops_ac9094e82a42f3669f55be6ba1d2e8d3b_icgraph" id="namespacecrops_ac9094e82a42f3669f55be6ba1d2e8d3b_icgraph">
<area shape="rect" id="node2" href="namespacephenology__methods.html#a6206ebfca079af3c56d3c11d70b82c85" title="phenology_methods::\lphenology3" alt="" coords="323,5,469,47"/>
<area shape="rect" id="node5" href="namespacecrops.html#a132790a49a69bada45c7aaf94deb1a78" title="Crops Seasonality. " alt="" coords="332,71,460,98"/>
<area shape="rect" id="node6" href="namespacecrops.html#a5d606228c6bf81247e263a6e8972c019" title="Get vernalisation factors for crops. " alt="" coords="176,42,275,69"/>
<area shape="rect" id="node3" href="namespacephenology__methods.html#a147419bfb677634e26bf5de75edc2714" title="phenology_methods::\lphenology" alt="" coords="517,5,664,47"/>
<area shape="rect" id="node4" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="712,42,771,69"/>
</map>
</div>

</div>
</div>
<a id="a2c8946984659d8cc631e0f90913c45e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8946984659d8cc631e0f90913c45e2">&#9670;&nbsp;</a></span>winterday()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function crops::winterday </td>
          <td>(</td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(12)&#160;</td>
          <td class="paramname"><em>mmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nn1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the start day of winter as defined by a threshold temperature. </p>
<p>thresh IN threshold temperature for winter mmid(12) IN Midday of month in Julian days</p>
<dl class="section author"><dt>Author</dt><dd>LLT,EPK </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Oct 2016 </dd></dl>

<p class="definition">Definition at line <a class="el" href="crops_8f90_source.html#l00486">486</a> of file <a class="el" href="crops_8f90_source.html">crops.f90</a>.</p>

<p class="reference">References <a class="el" href="site__parameters_8f90_source.html#l00067">site_parameters::ssp</a>.</p>

<p class="reference">Referenced by <a class="el" href="crops_8f90_source.html#l00058">seasonality()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecrops_a2c8946984659d8cc631e0f90913c45e2_icgraph.png" border="0" usemap="#namespacecrops_a2c8946984659d8cc631e0f90913c45e2_icgraph" alt=""/></div>
<map name="namespacecrops_a2c8946984659d8cc631e0f90913c45e2_icgraph" id="namespacecrops_a2c8946984659d8cc631e0f90913c45e2_icgraph">
<area shape="rect" id="node2" href="namespacecrops.html#a132790a49a69bada45c7aaf94deb1a78" title="Crops Seasonality. " alt="" coords="171,5,299,32"/>
<area shape="rect" id="node3" href="sdgvm_8f90.html#a8622b607d8be793fa44e2984139d5bf5" title="sdgvm" alt="" coords="347,5,405,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer" style="font-weight: bold;">&copy; 2018 Leverhulme Center for Climate Change Mitigation (LC3M)
      <a href="http://www.doxygen.org/index.html">
<!---        <img class="footer" src="LC3M2.png" alt="doxygen"/>
--->
      </a>
    </li>
  </ul>
</div>
</body>
</html>
